VAR faith_path = "undecided"
VAR vladimir_trust = 5
VAR people_mood = 0
VAR beauty_awakened = 0

CONST MAX_TRUST = 10
CONST MIN_TRUST = 0

VAR idols_destroyed = false
VAR witnessed_byzantium = false
VAR baptized = false

//LIST religions = "pagan", "islam", "catholic", "orthodox", "undecided"
-> start_game

=== start_game ===
// Вступление
# intro
#Location: интро
986 год от Рождества Христова. Киев. Вы — Иван, молодой дружинник на службе у великого князя Владимира. Русь сильна, но разобщена. Князь ищет путь, который объединит племена и возвысит его державу в глазах мира. Ваша служба начинается в день большого совета...

-> druzhina_council

=== druzhina_council ===
# council
#Location: дружина
В гриднице дымно и шумно. Князь Владимир слушает доклады воевод: мятежи на окраинах, набеги печенегов, ропот среди знати, которая чтит старых богов. Князь тяжко вздыхает: "Сила наша — в единстве. Но что может сплотить всех: и кривича, и вятича, и полянина?"

Воевода Блуд, ваш непосредственный начальник, бросает на вас оценивающий взгляд: "Ну, молодой, что скажешь? Уши-то у тебя на месте?"

*   [Предложить искать новую, сильную веру для объединения] 
    ~vladimir_trust += 1
    "Может, стоит послушать, какие веры есть у соседей? Чтобы все как один..." — осторожно говорите вы.
    -> pagan_rites
    
*   [Сказать, что сила в мече и старых богах] 
    ~people_mood += 1
    ~vladimir_trust -= 1
    "Сила Руси — в дружине да в Перуне-громовержце!" — бодро отвечаете вы.
    -> pagan_rites
    
*   [Промолчать, служа верно]
    "Мое дело — слушать и выполнять, боярин," — почтительно кланяетесь вы.
    -> pagan_rites

=== pagan_rites ===
# rites
#Location: ритес
По пути из гридницы вы слышите гул толпы. На холме у идола Перуна жрец проводит обряд. Люди молятся, но в их глазах больше страха, чем надежды. Вы слышите шепот: "Боги молчат... жертвы напрасны..."

+ {people_mood < 0}
*   [Участвовать в обряде, чтобы успокоить народ]
    Вы подходите к костру, делая вид, что разделяете общую мольбу. 
    ~people_mood = people_mood+1
    -> envoys_arrive


{
- vladimir_trust > 3:
*   [Доложить князю о народном недовольстве]
    Вы спешите обратно во дворец. Князь выслушивает ваш доклад кивком. 
    ~vladimir_trust = vladimir_trust+1
    -> envoys_arrive
- else:

*   [Пройти мимо, не вмешиваясь]
    Вы отворачиваетесь и идёте своей дорогой, оставляя ропот за спиной.
    -> envoys_arrive
}
=== envoys_arrive ===
# envoys
#Location: энвойс
В Киев прибыли посольства. Князь велит вам присутствовать при их представлении и составить своё мнение. "Слушай ушами, дружинник, а не языком," — наставляет вас Блуд.

К кому вы подойдёте в первую очередь?

*   [Хазарский раввин] 
    -> dialogue_judaism
*   [Болгарский имам] 
    -> dialogue_islam
*   [Немецкий священник] 
    -> dialogue_catholic
*   [Греческий философ] 
    -> dialogue_orthodox

=== dialogue_orthodox ===
# orthodox
#Location: грек
Греческий философ говорит тихо и мудро. Он рассказывает о любви, о красоте богослужения в Царьграде, о вере, которая построила великую империю.

*   [Расспросить о красоте богослужения]
    "Красота... Она может тронуть сердце?" — спрашиваете вы.
    ~beauty_awakened = beauty_awakened+1
    -> after_orthodox_choice
    
*   [Спросить о власти императора и церкви]
    "А кто в вашей вере главнее — царь или патриарх?" — интересуетесь вы, как воин.
    -> after_orthodox_choice
    
*   [Усомниться: "Красота — это хорошо, но строги ли ваши законы?"]
    "У нас в дружине ценят твёрдость," — говорите вы.
    -> after_orthodox_choice

=== after_orthodox_choice ===
{
- beauty_awakened >= 2 and witnessed_byzantium == false:
    Философ кладёт руку вам на плечо. "Юноша, ты готов увидеть. Дай мне рассказать тебе о Царьграде..."
    -> embassy_byzantium
- else:
    Вы благодарите философа и отходите, полный новых мыслей.
    faith_path = "orthodox"
    -> vladimir_decision_check
}

=== embassy_byzantium ===
Грек говорит с таким жаром, что кажется, будто вы переноситесь в Константинополь. "Представь купол Святой Софии, парящий как небо... голоса ангельского хора... там душа находит покой, которого не даст ни один бог войны."
~witnessed_byzantium = true
~faith_path = "orthodox"
~beauty_awakened = 3
~vladimir_trust = vladimir_trust+2

Вы стоите, ошеломлённый. Это было... откровение.
-> vladimir_decision_check

=== vladimir_decision_check ===
{
- vladimir_trust >= 6:
    -> vladimir_decision
- else:
    // Если доверия недостаточно, игрок не допущен к тайному совету
    Князь принимает решение без вашего участия. Вам лишь приказывают готовиться к большим переменам.
    -> baptism_preparations
}

=== vladimir_decision ===
# secret_council
#Location: секрет рум
Вас вызывают к князю в его личные покои. Кроме вас там только Блуд и двое самых доверенных воевод.
"Ты видел и слышал многое, дружинник, — говорит Владимир, глядя на вас пристально. — Я сделал выбор. Русь примет крещение по греческому обряду. Но будет трудно. Старая вера сильна в сердцах. Будешь со мной в этот час?"

*   ["Клянусь служить вам и новой вере всем сердцем!"]
    ~vladimir_trust = MAX_TRUST
    ~faith_path = "orthodox"
    "Верный пёс," — хмыкает Блуд, но в его глазах уважение.
    -> baptism_preparations
    
*   ["Мой долг — служить князю. А вера... дело сердца."]
    ~vladimir_trust = vladimir_trust-2
    Князь хмурится, но кивает: "Честный ответ. Оставайся при своём долге."
    -> baptism_preparations
    
*   ["Князь, прости, но я не могу отречься от богов отцов."]
    ~vladimir_trust = MIN_TRUST
    ~faith_path = "pagan"
    Лицо Владимира темнеет. "Вольно. Но с этого дня ты не в моей дружине. Уходи."
    -> outcast_path

=== baptism_preparations ===
# preparations
#Location: минус_перун
Приказ дан. Идол Перуна свергнуть и сжечь. На площади кипит ярость одних и надежда других. Жрецы проклинают князя. Вас посылают поддерживать порядок.
{
- faith_path == "orthodox" and vladimir_trust >= 8
*   [Взять топор и помочь волочь идола к реке]
    Вы бросаетесь вперёд, чувствуя, как вместе с тяжеленным изваянием в воду уходит целая эпоха.
    ~idols_destroyed = true
    ~people_mood = people_mood-2
    -> mass_baptism_dnieper

- faith_path == "pagan" and vladimir_trust > 0
*   [Встать между толпой и жрецами, пытаясь предотвратить кровопролитие]
    Вы кричите, чтобы люди одумались, но вас едва не сбивают с ног. Вы теряете свой шлем в давке.
    ~people_mood = people_mood+1
    ~vladimir_trust = vladimir_trust-3
    -> mass_baptism_dnieper
}

*   [Наблюдать со стороны, с тяжелым сердцем]
    Вы стоите в стороне, не в силах ни помочь, ни помешать. Сердце сжимается.
    -> mass_baptism_dnieper

=== mass_baptism_dnieper ===
# baptism_day
#Location: баптисм
Настал день. Тысячи киевлян на берегу Днепра. Византийские священники в золотых ризах. Князь Владимир стоит впереди всех. Его лицо преображено — в нём решимость и мир. Вода холодная, даже смотря на неё с берега.
{
- faith_path == "orthodox" and baptized == false
*   [Войдя в воду, принять крещение]
    Вы снимаете плащ и меч, делаете шаг в ледяную воду... и чувствуете не холод, а странное, новое тепло. ~baptized = true
    -> good_ending_orthodox
    
- faith_path == "pagan"
*   [Остаться на берегу, наблюдая, как уходит старая эпоха]
    Вы стоите на высоком берегу, глядя, как народ сходит в воду. Ветер доносит молитвы на непонятном языке. Вы остаётесь в прошлом.
    -> ending_pagan_outcast
    
- vladimir_trust >= 7
*   [Стоять в оцеплении, охраняя новый обряд, как верный страж]
    Вы держите строй, глядя прямо перед собой. Ваш долг — порядок. Ваша вера — служба.
    -> ending_loyal_guardian
}

*   [Уйти прочь, в неизвестность]
    Вы разворачиваетесь и уходите от реки, от криков, от этой новой Руси, которая рождается без вас.
    -> ending_wanderer
=== good_ending_orthodox ===
# ending
#Location: новая_Русь
Вы стали частью новой Руси. Строятся храмы, звучит славянская письменность. Вы служите уже не просто князю, а идее единого христианского государства. Через годы вы станете воеводой, а ваши дети будут расти в граде, где звонят колокола. Вы помогли свершиться истории.
-> END

=== ending_pagan_outcast ===
# ending
#Location: конец_каганов
Вас изгнали из дружины. Вы ушли в леса, к тем, кто помнит старых богов и старые пути. Вы — последний след ушедшей эпохи, «старовер» в новом, чуждом мире, что строится на пепелище капищ. Ваша песня больше никем не будет спета.
-> END

=== ending_loyal_guardian ===
# ending
#Location: остаться_но_не_креститься
Князь оценил вашу верную службу, хотя так и не понял ваших сомнений. Вы остались в дружине, охраняя новый порядок. Вы стоите на стене и смотрите на город с крестами на храмах. Это не ваша вера, но это ваша земля. И вы будете защищать её — отныне и до конца своих дней.
-> END

=== ending_wanderer ===
# ending
#Location: бегство
Киев остался за спиной. Вы идёте на восток, где ещё сильны старые боги, или на запад, где другие князья и другие веры. Ваша судьба — дорога. Вы не выбрали ни Русь старую, ни Русь новую. Вы выбрали только себя.
-> END

=== outcast_path ===
# outcast
Вы — изгой. Без княжеской милости, без дружины. Вам остаётся лишь одно...
*   [Уйти в леса] -> ending_pagan_outcast
*   [Попытаться уйти к печенегам] -> ending_mercenary

=== ending_mercenary ===
# ending
#Location: наемник
Нанятый меч в степи. Вы воюете за тех, кто платит, забыв и о князе, и о богах. Иногда ночью вам снится звон колоколов, которого вы никогда не слышали наяву.
-> END



=== dialogue_judaism ===
# хазары
Хазарский раввин — старик с проницательными глазами, говорит спокойно и уверенно. Он рассказывает о едином Боге, давшем закон Моисею, о народе, избранном хранить этот закон, несмотря на рассеяние по миру.

Хазар: "Наша вера — вера Закона и Завета", — говорит он, поглаживая свиток.

*   [Спросить о едином Боге]
    "Как один Бог может управлять всем миром?" — спрашиваете вы, привыкший к множеству духов и божков.
    Раввин улыбаестя
    Хазар: "Как один князь управляет дружиной. Не множество вождей, но один — и порядок." {faith_path == "judaism"}
    -> after_judaism_choice
    
*   [Спросить о земле и царстве]
    "Но где же ваше царство? Где земля, где правит ваш народ?"
    Лицо старика становится печальным. 
    Хазар: "Наше царство — в душах и в Законе. Земные же царства преходят..." {people_mood == people_mood-1} // Мысль о народе без земли тревожит воина.
    -> after_judaism_choice

=== after_judaism_choice ===
Вы благодарите раввина. Его слова мудры, но идея народа без сильного земного царства кажется вам странной и непригодной для молодой, воинственной Руси.
-> return_to_envoys

=== dialogue_islam ===
# болгары
#Location: болгар
Болгарский имам, одетый в простые, но чистые одежды, говорит страстно о силе и дисциплине. "Нет Бога, кроме Аллаха, и Мухаммад — пророк Его. Вера очищает, возвышает и делает народ сильным. Запрет на вино делает ум ясным, запрет на ростовщичество — общество справедливым."

*   [Спросить о силе и войне]
    "Вы говорите о силе. А что говорит ваша вера о воинах?" — интересуетесь вы, дружинник.
    "Война за веру — путь в рай для храброго! Но и милость к побеждённому — заповедь." {faith_path == "islam"} {vladimir_trust == vladimir_trust+1} // Князю понравится этот воинственный дух.
    -> after_islam_choice
    
*   [Удивиться запретам]
    "А как же пир после победы? Без вина? И свинины?"
    Имам строго качает головой: "Послушание Богу выше удовольствий тела. Это и есть истинная сила." {people_mood == people_mood-1} // Русскому дружиннику такая аскеза кажется чрезмерной.
    -> after_islam_choice

=== after_islam_choice ===
Идея сильной, дисциплинированной веры вас заинтересовала, но суровые запреты вызывают сомнение. Вырастет ли дружина без братской чаши?
-> return_to_envoys

=== dialogue_catholic ===
# немцы
#Location: немец
Немецкий священник в тёмном одеянии говорит чётко и сурово. Он рассказывает о власти Папы в Риме, наместника Бога на земле, о строгой иерархии, о латинской грамоте и порядке, исходящем из единого центра.

"Подчинись Риму, и обретёшь истинную веру и место среди цивилизованных народов Европы", — звучит его речь.

*   [Спросить о власти Папы]
    "И кто же тогда главный в земле — князь или ваш Папа?"
    "Духовная власть — выше светской. Князь должен слушать наставления Церкви," — отвечает священник без тени сомнения. {vladimir_trust == vladimir_trust-1} // Эта мысль не понравится Владимиру.
    -> after_catholic_choice
    
*   [Спросить о вере для простого человека]
    "А если человек не знает вашей латыни? Как он поймёт молитву?"
    "Церковь знает, что лучше для его души. Он должен слушать и верить," — говорит священник. {beauty_awakened == beauty_awakened-1} // В этом нет той красоты и доступности, о которой говорил грек.
    -> after_catholic_choice

=== after_catholic_choice ===
Вера немцев кажется вам холодной, строгой и слишком требовательной к власти князя. Не похоже, чтобы она прижилась здесь, в вольной Киевской Руси.
-> return_to_envoys

=== return_to_envoys ===
Вы возвращаетесь в общий зал. У вас ещё есть время поговорить с другими послами или осмыслить услышанное.
*   [Подойти к хазарскому раввину] -> dialogue_judaism
*   [Подойти к болгарскому имаму] -> dialogue_islam
*   [Подойти к немецкому священнику] -> dialogue_catholic
*   [Подойти к греческому философу] -> dialogue_orthodox
*   [Закончить слушать. У меня уже есть мнение.] -> vladimir_decision_check

=== scene_old_believer_forest ===
# лес
#Location: лес
(Доступен только по ветке outcast_path, если faith_path == "pagan")
Глухой лес за пределами Киева. Вы встречаете небольшую группу таких же, как вы — тех, кто не принял новую веру. Они живут в страхе, но с гордостью.

Старый резчик по дереву, бывший жрец Даждьбога, говорит у костра:
"Они могут крестить воду в реке, но не смогут крестить лес. Не смогут крестить ветер. Наши боги здесь. Мы — последние. Ты с нами?"

*   [Остаться с ними. Они — ваша новая семья.] 
    ~faith_path = "pagan_old" // Особая метка
    -> ending_pagan_outcast
    
*   [Уйти дальше. Вы не хотите жить в страхе.]
    -> ending_wanderer

=== scene_pecheneg_camp ===
# печенеги
#Location: печенеги
(Доступен по ветке outcast_path)
Лагерь в степи. Запах конины и дыма. Печенежский хан смотрит на вас, оценивая.
"Киевский пес, которого выгнал свой же князь? Ха! Меч-то у тебя есть. Умеешь им пользоваться? Будешь служить мне — будешь есть мясо и пить кумыс. Забудешь своих богов и своих князей."

*   [Принять предложение. Вы — воин, и ваше место там, где дерутся.] 
    -> ending_mercenary
    
*   [Отказаться. Вы не готовитесь стать наёмником у степняков.]
    "Тогда убирайся из моей степи, пока твоя шкура цела!" — рычит хан.
    -> scene_old_believer_forest // Возврат к другому выбору

=== scene_church_construction ===
# стройка
#Location: стройка
(Доступен после baptism_preparations, если faith_path == "orthodox" и vladimir_trust > 5)
После низвержения идолов князь повелевает строить первую церковь на холме. Вас назначают наблюдать за работой. Вы видите, как византийские мастера учат местных плотников новым приёмам. Один из старых дружинников, работая с деревом, бормочет: "Для Перуна рубили иначе... крепче было..."

*   [Прикрикнуть на него: "Новая вера — новые порядки!"] 
    ~vladimir_trust = vladimir_trust+1
    ~people_mood = people_mood-1
    Работа продолжается в напряжённом молчании.
    -> mass_baptism_dnieper
    
*   [Подойти и помочь ему, молча взявшись за бревно.]
    Старый воин смотрит на вас с удивлением, затем кивает. Работа спорится.
    ~people_mood = people_mood+1
    -> mass_baptism_dnieper
    
*   [Промолчать и пройти мимо.]
    -> mass_baptism_dnieper
